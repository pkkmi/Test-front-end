<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Information</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-4">
        <h1>Debug Information</h1>
        
        <div class="alert alert-warning">
            This page shows debug information about the application state.
        </div>
        
        <!-- System Status -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h3>System Status</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <!-- Database Status -->
                    <div class="col-md-6">
                        <div class="card mb-3">
                            <div class="card-header">Database Status</div>
                            <div class="card-body">
                                {% if db_status %}
                                    <span class="badge badge-{{ 'warning' if 'fallback' in db_status else 'success' }} p-2">
                                        {{ db_status }}
                                    </span>
                                {% else %}
                                    <span class="badge badge-secondary p-2">Unknown</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- API Status -->
                    <div class="col-md-6">
                        <div class="card mb-3">
                            <div class="card-header">API Connection</div>
                            <div class="card-body">
                                {% if api_status %}
                                    <span class="badge badge-{{ 'success' if api_status.status == 'online' else 'danger' }} p-2">
                                        {{ api_status.status }}
                                    </span>
                                    {% if api_status.message %}
                                        <p class="mt-2 mb-0 small">{{ api_status.message }}</p>
                                    {% endif %}
                                {% else %}
                                    <span class="badge badge-secondary p-2">Unknown</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- User Information -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h3>Current User</h3>
            </div>
            <div class="card-body">
                {% if user_info %}
                <table class="table table-bordered">
                    <tbody>
                        {% for key, value in user_info.items() %}
                        <tr>
                            <th>{{ key }}</th>
                            <td>
                                {% if key == 'usage' %}
                                <ul>
                                    {% for usage_key, usage_value in value.items() %}
                                    <li><strong>{{ usage_key }}:</strong> {{ usage_value }}</li>
                                    {% endfor %}
                                </ul>
                                {% else %}
                                {{ value }}
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div class="alert alert-warning">No user information available</div>
                {% endif %}
            </div>
        </div>
        
        <!-- Session Data -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h3>Session Data</h3>
            </div>
            <div class="card-body">
                {% if session %}
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for key, value in session.items() %}
                        <tr>
                            <td>{{ key }}</td>
                            <td>{{ value }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div class="alert alert-warning">No session data available</div>
                {% endif %}
            </div>
        </div>
        
        <!-- API Status Details -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h3>API Status Details</h3>
            </div>
            <div class="card-body">
                {% if api_status %}
                <table class="table table-bordered">
                    <tbody>
                        {% for key, value in api_status.items() %}
                        <tr>
                            <th>{{ key }}</th>
                            <td>{{ value }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div class="alert alert-warning">No API status information available</div>
                {% endif %}
            </div>
        </div>
        
        <!-- Tier Information -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h3>Tier Information</h3>
            </div>
            <div class="card-body">
                {% if tiers %}
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Tier</th>
                            <th>Word Limit</th>
                            <th>Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for tier_key, tier_info in tiers.items() %}
                        <tr>
                            <td>{{ tier_key }}</td>
                            <td>{{ tier_info.max_words }}</td>
                            <td>{{ tier_info.name }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div class="alert alert-warning">No tier information available</div>
                {% endif %}
            </div>
        </div>
        
        <div class="mt-4">
            <a href="{{ url_for('index') }}" class="btn btn-primary">Go to Home</a>
            <a href="{{ url_for('health_check') }}" class="btn btn-secondary ml-2">Health Check API</a>
        </div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
